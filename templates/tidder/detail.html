{% extends 'tidder/base.html' %}

{% load story_extras %}

{% load static %}

{% block title %}Tidder - {{ story.title }}{% endblock %}

{% block content %}

<p>
<h3><a href="{{ story.url }}">{{ story.title }}</a><small>  {% if story.domain %} ({{ story.domain }}) {% endif %}</small></h3>
</p>

<p>
{{ story.points }} points by <b><a href="/user_profile/{{ story.moderator.username }}">{{ story.moderator.username }}</a></b> {{ story.created_at|age }}
</p>

<p>
{{ story.description }}
</p>

<hr/>

<h4>Add Comment:</h4>

{% if user.is_authenticated %}
	<form id="postcomment" method="post" action="">
			{% for hidden in form.hidden_fields %}
			{{ hidden }}
			{% endfor %}
			<textarea class="form-control" rows="3" placeholder="Description" name="content" value="" required></textarea>
			<button class="btn btn-sm btn-primary" type="submit" name="Submit">Submit</button>
			{% csrf_token %}
		</form>
{% else %}
	<p><a href="{% url 'login' %}"><b>Login</b></a> to Comment</p>
{% endif %}

<hr/>

<ul id="commenters">
	{% for c in comment_tree %}     
		<li id="{{ c.id }}" class="c" style="margin-left:{{ c.depth|add:c.depth }}em;">
			<p class="poster"><b><a href="/user_profile/{{ c.comment_moderator.username }}">{{ c.comment_moderator.username }}</a></b> - {{ c.date |age }}</p>
			<p>{{ c.content }}</p>
			{% if user.is_authenticated %}
				<p><a href="" class="reply"><button type="button" class="btn btn-primary btn-xs">reply</button></a></p> 
			{% endif %}
		</li>
	{% empty %}
<br/>
	<p>There are currently no comments.</p>
	{% endfor %}
</ul>

{% endblock content %}